<!-- This defines instructions described in PowerISA Version 3.0 B Book 1 -->

<!-- These are not described in book 1 -->

# setvl

SVL-Form

* setvl RT, RA, SVi, vs, ms
* setvl. RT, RA, SVi, vs, ms

Pseudo-code:

    VLimm <- SVi + 1
    if vs = 1 then
        if _RA != 0 then
            VL <- (RA|0)[57:63]
        else
            VL <- VLimm[1:7]
    else
        VL <- SVSTATE[7:13]
    if ms = 1 then
        MVL <- VLimm[1:7]
    else
        MVL <- SVSTATE[0:6]
    if VL > MVL then
        VL = MVL
    SVSTATE[0:6] <- MVL
    SVSTATE[7:13] <- VL
    RT <- [0]*57 || VL

Special Registers Altered:

    CR0                     (if Rc=1)

# svremap

SVM-Form

* svstate SVxd, SVyd, SVRM

Pseudo-code:

    # hack: clear out all SVSHAPEs and set them up for multiply
    SVSHAPE0[0:31] <- [0] * 32
    SVSHAPE1[0:31] <- [0] * 32
    SVSHAPE2[0:31] <- [0] * 32
    SVSHAPE3[0:31] <- [0] * 32
    # set up FRT and FRB
    SVSHAPE0[0:5] <- (0b0 || SVxd)   # xdim
    SVSHAPE3[0:5] <- (0b0 || SVxd)   # xdim
    # set up FRA
    SVSHAPE0[0:5] <- (0b0 || SVxd)   # xdim
    SVSHAPE0[6:11] <- (0b0 || SVyd)  # ydim
    SVSHAPE0[18:20] <- 0b010          # permute y,x,z

Special Registers Altered:

    None

